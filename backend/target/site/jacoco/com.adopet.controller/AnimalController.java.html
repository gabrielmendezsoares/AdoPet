<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AnimalController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AdoPet</a> &gt; <a href="index.source.html" class="el_package">com.adopet.controller</a> &gt; <span class="el_source">AnimalController.java</span></div><h1>AnimalController.java</h1><pre class="source lang-java linenums">package com.adopet.controller;

import com.adopet.model.Animal;
import com.adopet.service.AnimalService;
import com.adopet.exception.ResourceNotFoundException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.Parameter;
import io.swagger.v3.oas.annotations.responses.ApiResponse;
import io.swagger.v3.oas.annotations.responses.ApiResponses;
import io.swagger.v3.oas.annotations.tags.Tag;
import java.util.List;
import java.util.Optional;

@RestController
@RequestMapping(&quot;/animals&quot;)
@CrossOrigin(origins = &quot;http://localhost:3000&quot;, methods = { RequestMethod.GET, RequestMethod.POST, RequestMethod.PUT,
    RequestMethod.DELETE, RequestMethod.PATCH, RequestMethod.OPTIONS })
@Tag(name = &quot;AnimalController&quot;, description = &quot;Controlador de animais.&quot;)
public class AnimalController {

  private final AnimalService animalService;

  @Autowired
<span class="fc" id="L28">  public AnimalController(AnimalService animalService) {</span>
<span class="fc" id="L29">    this.animalService = animalService;</span>
<span class="fc" id="L30">  }</span>

  /**
   * Retorna todos os animais.
   * 
   * @return lista de todos os animais
   */
  @Operation(summary = &quot;Buscar todos os animais&quot;, description = &quot;Retorna uma lista de todos os animais.&quot;)
  @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Lista de animais retornada com sucesso&quot;)
  @GetMapping
  public ResponseEntity&lt;List&lt;Animal&gt;&gt; findAll() {
<span class="fc" id="L41">    List&lt;Animal&gt; animals = animalService.findAll();</span>

<span class="fc" id="L43">    return ResponseEntity.ok(animals);</span>
  }

  /**
   * Encontra um animal pelo ID.
   * 
   * @param id o ID do animal
   * @return o animal encontrado ou uma resposta de erro
   */
  @Operation(summary = &quot;Buscar animal por ID&quot;, description = &quot;Retorna um animal específico com base no ID fornecido.&quot;)
  @ApiResponses(value = {
      @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Animal encontrado&quot;),
      @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Animal não encontrado&quot;)
  })
  @GetMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;Animal&gt; findById(
      @Parameter(description = &quot;ID do animal que deseja buscar&quot;, required = true) @PathVariable Long id) {
<span class="nc" id="L60">    Optional&lt;Animal&gt; optionalAnimal = animalService.findById(id);</span>

<span class="nc bnc" id="L62" title="All 2 branches missed.">    if (optionalAnimal.isPresent()) {</span>
<span class="nc" id="L63">      return ResponseEntity.ok(optionalAnimal.get());</span>
    } else {
<span class="nc" id="L65">      throw new ResourceNotFoundException(&quot;Animal not found with id &quot; + id);</span>
    }
  }

  /**
   * Cria um novo animal.
   * 
   * @param newAnimal o animal a ser criado
   * @return o animal criado
   */
  @Operation(summary = &quot;Criar um novo animal&quot;, description = &quot;Cria um novo registro de animal.&quot;)
  @ApiResponses(value = {
      @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Animal criado com sucesso&quot;),
      @ApiResponse(responseCode = &quot;400&quot;, description = &quot;Erro na criação do animal&quot;)
  })
  @PostMapping
  public ResponseEntity&lt;Animal&gt; create(@RequestBody Animal newAnimal) {
<span class="fc" id="L82">    Animal createdAnimal = animalService.create(newAnimal);</span>

<span class="fc" id="L84">    return ResponseEntity.status(HttpStatus.CREATED).body(createdAnimal);</span>
  }

  /**
   * Atualiza um animal pelo ID.
   * 
   * @param id        o ID do animal a ser atualizado
   * @param newAnimal o animal com os novos dados
   * @return o animal atualizado
   */
  @Operation(summary = &quot;Atualizar um animal&quot;, description = &quot;Atualiza os dados de um animal existente com base no ID.&quot;)
  @ApiResponses(value = {
      @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Animal atualizado com sucesso&quot;),
      @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Animal não encontrado&quot;),
      @ApiResponse(responseCode = &quot;400&quot;, description = &quot;Erro na atualização do animal&quot;)
  })
  @PutMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;Animal&gt; update(
      @Parameter(description = &quot;ID do animal que deseja atualizar&quot;, required = true) @PathVariable Long id,
      @RequestBody Animal newAnimal) {
<span class="nc" id="L104">    Optional&lt;Animal&gt; optionalAnimal = animalService.findById(id);</span>

<span class="nc bnc" id="L106" title="All 2 branches missed.">    if (!optionalAnimal.isPresent()) {</span>
<span class="nc" id="L107">      throw new ResourceNotFoundException(&quot;Animal not found with id &quot; + id);</span>
    }

<span class="nc" id="L110">    Animal updatedAnimal = animalService.update(optionalAnimal.get(), newAnimal);</span>

<span class="nc" id="L112">    return ResponseEntity.ok(updatedAnimal);</span>
  }

  /**
   * Deleta um animal pelo ID.
   * 
   * @param id o ID do animal a ser deletado
   * @return uma resposta vazia
   */
  @Operation(summary = &quot;Deletar um animal&quot;, description = &quot;Remove um animal do sistema com base no ID fornecido.&quot;)
  @ApiResponses(value = {
      @ApiResponse(responseCode = &quot;204&quot;, description = &quot;Animal deletado com sucesso&quot;),
      @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Animal não encontrado&quot;)
  })
  @DeleteMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;Void&gt; delete(
      @Parameter(description = &quot;ID do animal que deseja deletar&quot;, required = true) @PathVariable Long id) {
<span class="pc bpc" id="L129" title="1 of 2 branches missed.">    if (!animalService.existsById(id)) {</span>
<span class="nc" id="L130">      throw new ResourceNotFoundException(&quot;Animal not found with id &quot; + id);</span>
    }

<span class="fc" id="L133">    animalService.delete(id);</span>

<span class="fc" id="L135">    return ResponseEntity.noContent().build();</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>